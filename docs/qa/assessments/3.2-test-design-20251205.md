# Test Design: Story 3.2 - Angular Project Foundation

**Date:** 2025-12-05
**Designer:** Quinn (Test Architect)
**Story:** Angular Project Foundation
**Status:** Approved

---

## Test Strategy Overview

| Metric | Count | Percentage |
|--------|-------|------------|
| **Total Test Scenarios** | 24 | 100% |
| Unit Tests (Jasmine/Karma) | 10 | 42% |
| Integration Tests (Playwright MCP) | 8 | 33% |
| E2E/Visual Tests (Chrome DevTools MCP) | 6 | 25% |

**Priority Distribution:**
- P0 (Critical): 6 tests
- P1 (High): 10 tests
- P2 (Medium): 6 tests
- P3 (Low): 2 tests

---

## Testing Tools & Frameworks

### Unit Tests - Jasmine/Karma
- **Framework:** Angular's built-in testing with Jasmine + Karma
- **Location:** `web/src/app/**/*.spec.ts`
- **Execution:** `cd web && ng test`
- **Coverage Target:** 80%+

### Integration Tests - Playwright MCP
- **Tool:** Playwright MCP Server (`@executeautomation/playwright-mcp-server`)
- **Capabilities:** Browser automation, form interaction, screenshot capture
- **Execution:** Via MCP tool calls during QA verification

### E2E/Visual Tests - Chrome DevTools MCP
- **Tool:** Chrome DevTools MCP Server (`chrome-devtools-mcp`)
- **Capabilities:** Accessibility tree snapshots, performance analysis, visual verification
- **Execution:** Via MCP tool calls against running Angular app

---

## Test Scenarios by Acceptance Criteria

### AC1: Angular project created in `/web` directory using Angular CLI (LTS version)

| ID | Level | Priority | Test Description | Justification | Tool |
|----|-------|----------|------------------|---------------|------|
| 3.2-UNIT-001 | Unit | P0 | Verify Angular version is 18.x in package.json | Pure file validation | Jasmine |
| 3.2-INT-001 | Integration | P1 | Navigate to app and verify Angular runtime | Validate full app initialization | Playwright |

### AC2: Project builds successfully with `ng build`

| ID | Level | Priority | Test Description | Justification | Tool |
|----|-------|----------|------------------|---------------|------|
| 3.2-UNIT-002 | Unit | P0 | Verify app.component.ts compiles without errors | Component compilation | Jasmine |
| 3.2-INT-002 | Integration | P0 | Execute `ng build` and verify exit code 0 | Full build pipeline | CLI/Playwright |

### AC3: Basic single-page layout with header showing "JSONSchema Validator"

| ID | Level | Priority | Test Description | Justification | Tool |
|----|-------|----------|------------------|---------------|------|
| 3.2-UNIT-003 | Unit | P0 | AppComponent contains "JSONSchema Validator" in template | Template validation | Jasmine |
| 3.2-INT-003 | Integration | P1 | Navigate to app and verify header text visible | Runtime DOM check | Playwright |
| 3.2-E2E-001 | E2E | P1 | Take snapshot, verify header element in accessibility tree | Visual/A11y verification | Chrome DevTools |

**Playwright Test Pattern:**
```typescript
// Using playwright_navigate and playwright_get_visible_text
1. playwright_navigate: { url: "http://localhost:4200" }
2. playwright_get_visible_text: {}
3. Assert text contains "JSONSchema Validator"
```

**Chrome DevTools Test Pattern:**
```typescript
// Using take_snapshot for accessibility tree
1. navigate_page: { type: "url", url: "http://localhost:4200" }
2. take_snapshot: {}
3. Verify header element exists with correct text
```

### AC4: Split-pane layout implemented (left pane for JSON, right pane for Schema)

| ID | Level | Priority | Test Description | Justification | Tool |
|----|-------|----------|------------------|---------------|------|
| 3.2-UNIT-004 | Unit | P1 | JsonEditorComponent exists and is standalone | Component existence | Jasmine |
| 3.2-UNIT-005 | Unit | P1 | SchemaEditorComponent exists and is standalone | Component existence | Jasmine |
| 3.2-INT-004 | Integration | P1 | Both panes visible side-by-side in browser | Layout verification | Playwright |
| 3.2-E2E-002 | E2E | P2 | Screenshot shows two-column layout | Visual regression | Playwright/Chrome DevTools |

**Playwright Test Pattern:**
```typescript
// Verify split pane visibility
1. playwright_navigate: { url: "http://localhost:4200" }
2. playwright_get_visible_html: { selector: ".as-split" }
3. Assert two as-split-area elements exist
4. playwright_screenshot: { name: "split-pane-layout" }
```

### AC5: Panes are resizable (drag divider to adjust widths)

| ID | Level | Priority | Test Description | Justification | Tool |
|----|-------|----------|------------------|---------------|------|
| 3.2-INT-005 | Integration | P1 | Drag divider and verify pane width changes | Interactive behavior | Playwright |
| 3.2-E2E-003 | E2E | P2 | Screenshot before/after resize shows visual change | Visual verification | Chrome DevTools |

**Playwright Test Pattern:**
```typescript
// Test resizable divider
1. playwright_navigate: { url: "http://localhost:4200" }
2. playwright_screenshot: { name: "before-resize" }
3. playwright_drag: { sourceSelector: ".as-split-gutter", targetSelector: "..." }
4. playwright_screenshot: { name: "after-resize" }
5. Compare screenshots show width change
```

**Chrome DevTools Test Pattern:**
```typescript
// Test resize with element inspection
1. navigate_page: { url: "http://localhost:4200" }
2. take_snapshot: {} // Record initial widths
3. drag: { from_uid: "gutter-uid", to_uid: "target-uid" }
4. take_snapshot: {} // Verify widths changed
```

### AC6: "Validate" button positioned prominently below or between panes

| ID | Level | Priority | Test Description | Justification | Tool |
|----|-------|----------|------------------|---------------|------|
| 3.2-UNIT-006 | Unit | P0 | Validate button exists in template | Template check | Jasmine |
| 3.2-INT-006 | Integration | P0 | Button is visible and clickable | Interactive verification | Playwright |
| 3.2-E2E-004 | E2E | P1 | Button is prominently positioned (not hidden) | Visual prominence | Chrome DevTools |

**Playwright Test Pattern:**
```typescript
// Test Validate button
1. playwright_navigate: { url: "http://localhost:4200" }
2. playwright_click: { selector: "button:has-text('Validate')" }
3. Verify click succeeds (no error)
```

**Chrome DevTools Test Pattern:**
```typescript
// Test button in accessibility tree
1. navigate_page: { url: "http://localhost:4200" }
2. take_snapshot: {}
3. Find button element, verify role="button" and visible
4. click: { uid: "validate-button-uid" }
```

### AC7: Results area below editors for displaying validation output

| ID | Level | Priority | Test Description | Justification | Tool |
|----|-------|----------|------------------|---------------|------|
| 3.2-UNIT-007 | Unit | P1 | ValidationResultComponent exists and is standalone | Component existence | Jasmine |
| 3.2-INT-007 | Integration | P2 | Results area visible below split pane | Layout verification | Playwright |

**Playwright Test Pattern:**
```typescript
// Verify results area exists
1. playwright_navigate: { url: "http://localhost:4200" }
2. playwright_get_visible_html: { selector: "app-validation-result" }
3. Verify component exists in DOM
```

### AC8: Basic responsive behavior (panes stack vertically on narrow screens)

| ID | Level | Priority | Test Description | Justification | Tool |
|----|-------|----------|------------------|---------------|------|
| 3.2-UNIT-008 | Unit | P2 | CSS media query exists for narrow screens | Style validation | Jasmine |
| 3.2-INT-008 | Integration | P1 | Resize viewport to 600px, verify vertical stacking | Responsive behavior | Playwright |
| 3.2-E2E-005 | E2E | P2 | Screenshot at 600px shows vertical layout | Visual verification | Chrome DevTools |

**Playwright Test Pattern:**
```typescript
// Test responsive behavior
1. playwright_navigate: { url: "http://localhost:4200", width: 600, height: 800 }
2. playwright_screenshot: { name: "mobile-layout", fullPage: true }
3. playwright_get_visible_html: {}
4. Verify panes have vertical flex/grid direction
```

**Chrome DevTools Test Pattern:**
```typescript
// Test responsive with viewport resize
1. resize_page: { width: 600, height: 800 }
2. navigate_page: { url: "http://localhost:4200" }
3. take_snapshot: {}
4. Verify layout structure shows vertical stacking
5. take_screenshot: { format: "png" }
```

### AC9: Project configured for production build optimization

| ID | Level | Priority | Test Description | Justification | Tool |
|----|-------|----------|------------------|---------------|------|
| 3.2-UNIT-009 | Unit | P2 | angular.json has production optimization config | Config validation | Jasmine |
| 3.2-UNIT-010 | Unit | P3 | environment.prod.ts exists with production settings | Environment check | Jasmine |

### AC10: README in `/web` folder with build instructions

| ID | Level | Priority | Test Description | Justification | Tool |
|----|-------|----------|------------------|---------------|------|
| 3.2-E2E-006 | E2E | P3 | README.md exists and contains required sections | Documentation check | File Read |

---

## MCP Tool Usage Summary

### Playwright MCP Server Tests

| Test ID | Playwright Tool(s) Used | Purpose |
|---------|-------------------------|---------|
| 3.2-INT-001 | `playwright_navigate` | App initialization |
| 3.2-INT-003 | `playwright_navigate`, `playwright_get_visible_text` | Header verification |
| 3.2-INT-004 | `playwright_navigate`, `playwright_get_visible_html` | Split pane layout |
| 3.2-INT-005 | `playwright_navigate`, `playwright_drag`, `playwright_screenshot` | Resize functionality |
| 3.2-INT-006 | `playwright_navigate`, `playwright_click` | Button interaction |
| 3.2-INT-007 | `playwright_navigate`, `playwright_get_visible_html` | Results area |
| 3.2-INT-008 | `playwright_navigate` (with viewport), `playwright_screenshot` | Responsive |
| 3.2-E2E-002 | `playwright_screenshot` | Visual layout capture |

### Chrome DevTools MCP Server Tests

| Test ID | DevTools Tool(s) Used | Purpose |
|---------|----------------------|---------|
| 3.2-E2E-001 | `navigate_page`, `take_snapshot` | Accessibility tree |
| 3.2-E2E-003 | `take_snapshot`, `drag`, `take_screenshot` | Resize visual |
| 3.2-E2E-004 | `take_snapshot`, `click` | Button interaction |
| 3.2-E2E-005 | `resize_page`, `take_snapshot`, `take_screenshot` | Mobile layout |

---

## Risk Coverage

| Risk | Tests That Mitigate |
|------|---------------------|
| Angular build failure | 3.2-UNIT-002, 3.2-INT-002 |
| Layout not rendering | 3.2-INT-003, 3.2-INT-004, 3.2-E2E-002 |
| Split pane not functional | 3.2-INT-005, 3.2-E2E-003 |
| Validate button hidden/broken | 3.2-UNIT-006, 3.2-INT-006, 3.2-E2E-004 |
| Mobile layout broken | 3.2-INT-008, 3.2-E2E-005 |

---

## Recommended Execution Order

### Phase 1: Build Verification (Blocking)
1. `ng build` succeeds (3.2-INT-002)
2. `ng test` unit tests pass (3.2-UNIT-001 through 3.2-UNIT-010)

### Phase 2: Integration Tests (Playwright MCP)
1. Start dev server: `ng serve`
2. Execute Playwright tests in sequence:
   - 3.2-INT-001: App loads
   - 3.2-INT-003: Header visible
   - 3.2-INT-004: Split pane layout
   - 3.2-INT-005: Resize works
   - 3.2-INT-006: Button works
   - 3.2-INT-007: Results area exists
   - 3.2-INT-008: Responsive behavior

### Phase 3: Visual/E2E Tests (Chrome DevTools MCP)
1. Open Chrome with DevTools MCP connected
2. Execute Chrome DevTools tests:
   - 3.2-E2E-001: Accessibility snapshot
   - 3.2-E2E-002: Visual layout screenshot
   - 3.2-E2E-003: Resize visual verification
   - 3.2-E2E-004: Button prominence
   - 3.2-E2E-005: Mobile screenshot

---

## Quality Checklist

- [x] Every AC has test coverage
- [x] Test levels are appropriate (unit for logic, integration for behavior, e2e for visual)
- [x] No duplicate coverage across levels
- [x] Priorities align with business risk
- [x] Test IDs follow naming convention
- [x] Scenarios are atomic and independent
- [x] MCP tools identified for automation

---

## Gate YAML Block

```yaml
test_design:
  scenarios_total: 24
  by_level:
    unit: 10
    integration: 8
    e2e: 6
  by_priority:
    p0: 6
    p1: 10
    p2: 6
    p3: 2
  coverage_gaps: []
  mcp_tools:
    playwright:
      - playwright_navigate
      - playwright_get_visible_text
      - playwright_get_visible_html
      - playwright_click
      - playwright_drag
      - playwright_screenshot
    chrome_devtools:
      - navigate_page
      - take_snapshot
      - take_screenshot
      - resize_page
      - click
      - drag
```

---

## Next Steps for QA Execution

When Dev Agent completes Story 3.2:

1. **Run Unit Tests:**
   ```bash
   cd web
   ng test --no-watch --code-coverage
   ```

2. **Start Dev Server:**
   ```bash
   ng serve
   ```

3. **Execute Playwright MCP Tests:**
   - Use `playwright_navigate` to load http://localhost:4200
   - Execute integration test scenarios

4. **Execute Chrome DevTools MCP Tests:**
   - Connect to Chrome instance
   - Execute E2E test scenarios
   - Capture accessibility snapshots and screenshots

5. **Document Results:**
   - Update QA Results section in story
   - Create gate file with PASS/CONCERNS/FAIL decision
